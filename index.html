<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Clean Dash ‚Äî Octo Edition ¬∑ The Clean Home Crew LLC</title>
<meta name="description" content="75-second octopus cleaner: scrub grime, dodge pets, grab a 20% off coupon. Swipe, scrub, score!" />
<meta property="og:title" content="Clean Dash ‚Äî by The Clean Home Crew LLC">
<meta property="og:description" content="75-second octopus runner. Different spot sizes, pets to avoid, and a 20% off coupon each game.">
<meta property="og:type" content="website">
<meta property="og:image" content="https://thecleanhomecrew.com/wp-content/uploads/2024/01/og-clean-home-crew.jpg">
<meta property="og:url" content="https://example.com/cleandash">
<meta name="twitter:card" content="summary_large_image">

<link rel="icon" href="data:image/svg+xml;utf8,
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'>
  <rect width='64' height='64' rx='12' fill='%232f67ff'/>
  <circle cx='34' cy='28' r='12' fill='%23ff6f8f'/>
  <rect x='14' y='40' width='36' height='8' rx='4' fill='%23ffd43b'/>
</svg>">

<style>
  :root{
    --blue:#2f67ff; --blue-2:#1f47d8; --yellow:#ffd43b; --pink:#ff6f8f;
    --ink:#1f2b37; --bg:#ffffff; --muted:#7c8b98; --green:#12b886; --danger:#e45757;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
  a{color:var(--blue);text-decoration:none} a:hover{text-decoration:underline}
  .container{max-width:1100px;margin:0 auto;padding:24px}

  header{background:linear-gradient(145deg,var(--blue) 0%, var(--blue-2) 70%);color:#fff}
  header .container{padding:48px 24px 28px}
  .topbar{display:flex;align-items:center;justify-content:space-between;gap:18px}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:44px;height:44px;border-radius:12px;background:#fff;display:grid;place-items:center;box-shadow:0 6px 16px rgba(0,0,0,.12);font-size:26px}
  nav a{background:rgba(255,255,255,.18);padding:8px 12px;border-radius:999px;color:#fff;margin-left:6px}
  .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:24px;align-items:center}
  .hero h1{font-size:clamp(28px,4vw,48px);margin:10px 0 8px}
  .hero p{font-size:18px;opacity:.95;margin:0 0 18px}
  .cta-row{display:flex;gap:12px;flex-wrap:wrap}
  .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 16px;border-radius:12px;border:2px solid transparent;background:#fff;color:#0f172a;font-weight:800;cursor:pointer;box-shadow:0 6px 14px rgba(0,0,0,.08)}
  .btn.primary{background:var(--yellow);color:#231800}
  .btn.ghost{background:transparent;border-color:#fff;color:#fff}
  .note{font-size:13px;color:#eef2ff;margin-top:6px}

  .game-wrap{background:#fff;border-radius:18px;padding:14px;box-shadow:0 10px 28px rgba(0,0,0,.12);position:relative}
  canvas{width:100%;height:auto;border-radius:14px;background:linear-gradient(#eaf1ff,#fff)}
  .hud{position:absolute;top:10px;left:14px;right:14px;display:flex;justify-content:space-between;align-items:center;color:#0a1a44;font-weight:800}
  .hud .cluster{display:flex;gap:8px;flex-wrap:wrap}
  .badge{background:rgba(255,255,255,.82);padding:8px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.05)}
  .coupon-pop{position:absolute;top:60px;left:50%;transform:translateX(-50%);background:#fff;border:2px dashed var(--green);color:#065f46;padding:10px 14px;border-radius:12px;box-shadow:0 8px 18px rgba(0,0,0,.15);display:none;z-index:5}
  .coupon-pop button{margin-left:8px;background:var(--green);color:#fff;border:none;border-radius:8px;padding:6px 10px;font-weight:800}

  .mobile-controls{display:flex;gap:10px;justify-content:center;margin-top:10px;flex-wrap:wrap}
  .m-btn{flex:1;min-width:120px;background:var(--blue);color:white;padding:12px 14px;border-radius:12px;border:none;font-weight:800}

  .section{padding:56px 24px}
  .features{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
  .card{background:#fff;border-radius:14px;padding:18px;box-shadow:0 8px 18px rgba(0,0,0,.06)}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:24px}
  .email-form{display:flex;gap:10px}
  .email-form input{flex:1;padding:12px 14px;border-radius:10px;border:1px solid #d6e0e7}
  .email-form button{padding:12px 14px;border-radius:10px;background:var(--blue);color:white;border:none;font-weight:800}
  footer{background:#0e1b33;color:#c6d1e0}
  footer a{color:#b3c7ff}
  @media (max-width:960px){.hero{grid-template-columns:1fr}.features{grid-template-columns:1fr}.grid-2{grid-template-columns:1fr}}
</style>
</head>
<body>
  <header>
    <div class="container">
      <div class="topbar">
        <div class="brand">
          <div class="logo" aria-hidden="true">üêô</div>
          <div>
            <strong>The Clean Home Crew LLC</strong><br>
            <span style="font-size:12px;opacity:.9">Veteran‚ÄëOwned ¬∑ Eco‚ÄëFriendly ¬∑ Fully Insured</span>
          </div>
        </div>
        <nav>
          <a href="#play">Play</a>
          <a href="#how">How to Play</a>
          <a href="#share">Share</a>
          <a href="https://thecleanhomecrew.com/" target="_blank" rel="noopener">Book a Cleaning</a>
        </nav>
      </div>

      <div class="hero">
        <div>
          <h1>Clean Dash ‚Äî Octo Edition</h1>
          <p>75 seconds to scrub as much grime as you can. Different spot sizes = different points. Avoid scrubbing pets. Find the 20% off coupon!</p>
          <div class="cta-row">
            <a class="btn primary" href="#play">üïπÔ∏è Play in Browser</a>
            <button class="btn ghost" id="shareBtn">üîó Share</button>
          </div>
          <div class="note">Mobile + desktop. Hold <kbd>Space</kbd> (or tap ‚ÄúScrub‚Äù) when overlapping a spot.</div>
        </div>
        <div class="game-wrap" aria-label="Game preview">
          <div class="coupon-pop" id="couponPop">
            üéüÔ∏è <strong>20% OFF!</strong> Code: <span id="couponCode">TCHC20-XXXX</span>
            <button id="copyCoupon">Copy</button>
          </div>
          <div class="hud">
            <div class="cluster">
              <div class="badge">Score: <span id="hudScore">0</span></div>
              <div class="badge">Best: <span id="hudBest">0</span></div>
            </div>
            <div class="cluster">
              <div class="badge">Lives: <span id="hudLives">3</span></div>
              <div class="badge">Time: <span id="hudTime">75.0</span>s</div>
            </div>
          </div>
          <canvas id="game" width="600" height="900" role="img" aria-label="Clean Dash Game Canvas"></canvas>
          <div class="mobile-controls" aria-label="Game controls">
            <button class="m-btn" id="leftBtn">‚óÄÔ∏è Left</button>
            <button class="m-btn" id="scrubBtn">üßΩ Scrub</button>
            <button class="m-btn" id="rightBtn">Right ‚ñ∂Ô∏è</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <section class="section container" id="how">
      <div class="grid-2">
        <div>
          <h2>How to Play</h2>
          <ol>
            <li><strong>Move:</strong> Swipe left/right (mobile) or use arrow keys.</li>
            <li><strong>Scrub spots:</strong> Hold <em>Scrub</em> or press <kbd>Space</kbd>. 
              <em>Small</em>=+10, <em>Medium</em>=+20, <em>Large</em>=+35.</li>
            <li><strong>Coupon:</strong> One green ticket per game. Scrub it to collect a <strong>20% off</strong> code.</li>
            <li><strong>Pets (cat üê± & dog üê∂):</strong> Passing through is okay, but <em>don‚Äôt scrub them</em>‚Äîthat costs a life.</li>
            <li><strong>Ramp:</strong> Everything speeds up across the 75 seconds.</li>
          </ol>
        </div>
        <div>
          <h2>About The Clean Home Crew</h2>
          <p>Veteran‚Äëowned, fully insured, eco‚Äëfriendly supplies, and budget‚Äëfriendly, transparent pricing. We serve any city within 100 miles of Austin and 50 miles of La Grange, TX.</p>
          <p><a href="https://thecleanhomecrew.com/" target="_blank" rel="noopener">Get a free quote ‚Üí</a></p>
        </div>
      </div>
    </section>

    <section class="section container" id="play">
      <h2 style="text-align:center;margin-top:-8px">Beat the clock. Get the deal.</h2>
      <form class="email-form" onsubmit="event.preventDefault(); alert('Thanks! We‚Äôll ping you when new levels drop.');" style="justify-content:center">
        <input type="email" placeholder="Get updates (optional)" aria-label="Email for updates">
        <button>Notify Me</button>
      </form>
    </section>

    <section class="section container" id="share">
      <div class="grid-2">
        <div class="card">
          <h3>Share with friends, family & customers</h3>
          <p>Use the Share button or copy the link below.</p>
          <div style="display:flex;gap:8px">
            <input id="shareLink" value="https://example.com/cleandash" style="flex:1;padding:10px;border:1px solid #d6e0e7;border-radius:10px" readonly>
            <button class="btn" id="copyBtn">Copy</button>
          </div>
          <p style="font-size:13px;color:#64748b">Replace with your real URL after upload.</p>
        </div>
        <div class="card">
          <h3>Coupon redemption</h3>
          <p>Show your code at booking checkout or mention it to our team. One use per household, new bookings only.</p>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container" style="text-align:center">
      ¬© <span id="yr"></span> The Clean Home Crew LLC ¬∑ 100% Satisfaction Guarantee
    </div>
  </footer>

<script>
/* ===== Sharing & basics ===== */
const shareBtn=document.getElementById('shareBtn');
const copyBtn=document.getElementById('copyBtn');
const shareLink=document.getElementById('shareLink');
shareBtn?.addEventListener('click',async()=>{const url=shareLink.value;const data={title:'Clean Dash',text:'75-second Octo Edition! üêôüßΩ',url};try{ if(navigator.share){await navigator.share(data);} else {await navigator.clipboard.writeText(url); alert('Link copied!');} }catch(e){}});
copyBtn?.addEventListener('click',async()=>{try{await navigator.clipboard.writeText(shareLink.value); alert('Copied!');}catch(e){}});
document.getElementById('yr').textContent=new Date().getFullYear();

/* ===== Game: 75-second Octo Runner ===== */
const cvs=document.getElementById('game'), ctx=cvs.getContext('2d');
let W=cvs.width, H=cvs.height;
const lanes=[W*0.22,W*0.5,W*0.78];

let playerLane=1, score=0, best=+localStorage.getItem('cleandash_best')||0, lives=3;
let running=true, scrubbing=false, lastTs=performance.now(), elapsed=0; // seconds
const ROUND_TIME=75; // seconds

const hudScore=document.getElementById('hudScore'), hudBest=document.getElementById('hudBest'), hudLives=document.getElementById('hudLives'), hudTime=document.getElementById('hudTime');
hudBest.textContent=best;

const colors={blue:getCSS('--blue'), blue2:getCSS('--blue-2'), yellow:getCSS('--yellow'), pink:getCSS('--pink')};
function getCSS(v){return getComputedStyle(document.documentElement).getPropertyValue(v).trim();}

/* Entities: stains, coupon, pets */
const things=[]; 
// thing: { lane, y, kind: 'stain'|'coupon'|'cat'|'dog', w, h, points }
let couponSpawned=false, couponCollected=false, couponCode='';

function rng(min,max){return Math.random()*(max-min)+min;}

function spawn(progress){
  // progress: 0..1 across 75s
  // choose type by weights (more stains than pets)
  const r=Math.random();
  let kind='stain';
  if(!couponSpawned && r<0.06){ kind='coupon'; couponSpawned=true; }
  else if(r<0.18){ kind = Math.random()<0.5?'cat':'dog'; }
  // sizes for stains
  let w=44,h=28,points=20;
  if(kind==='stain'){
    const sizeRoll=Math.random();
    if(sizeRoll<0.4){ w=34; h=22; points=10; }          // small
    else if(sizeRoll<0.8){ w=48; h=30; points=20; }     // medium
    else { w=62; h=38; points=35; }                     // large
  } else if(kind==='coupon'){
    w=26; h=26; points=0;
  } else { // pets
    w=60; h=36; points=0;
  }
  things.push({ lane:Math.floor(Math.random()*3), y:-60, kind, w, h, points });
}

function drawBackground(frame){
  ctx.fillStyle='#eef3ff'; ctx.fillRect(0,0,W,H);
  ctx.setLineDash([10,18]); ctx.strokeStyle='#bccbff'; ctx.lineWidth=3;
  [0.36,0.64].forEach(x=>{ ctx.beginPath(); ctx.moveTo(W*x,0); ctx.lineTo(W*x,H); ctx.stroke(); });
  ctx.setLineDash([]);
  ctx.strokeStyle='rgba(47,103,255,.15)'; ctx.lineWidth=2;
  for(let y=(frame*12)%60; y<H; y+=60){ ctx.beginPath(); ctx.moveTo(W*0.1,y); ctx.lineTo(W*0.9,y+10); ctx.stroke(); }
}

/* Octopus */
const player={y:H*0.76};
function drawOctopus(x,y,frame){
  ctx.save(); ctx.translate(x,y);
  ctx.fillStyle='rgba(0,0,0,.08)'; ctx.beginPath(); ctx.ellipse(0,28,46,10,0,0,Math.PI*2); ctx.fill();
  ctx.fillStyle=colors.pink; // head/body
  ctx.beginPath(); ctx.ellipse(0,-6,44,38,0,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.moveTo(-40,5); ctx.quadraticCurveTo(0,18,40,5); ctx.quadraticCurveTo(6,28,-6,28); ctx.closePath(); ctx.fill();
  ctx.fillStyle='#1a1a1a'; ctx.beginPath(); ctx.arc(-14,-10,5,0,Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.arc(14,-10,5,0,Math.PI*2); ctx.fill();
  ctx.strokeStyle='#b4002b'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(0,-2,8,0,Math.PI); ctx.stroke();
  ctx.fillStyle=colors.blue; ctx.beginPath(); ctx.ellipse(-4,-32,28,12,-0.2,0,Math.PI*2); ctx.fill();
  ctx.fillStyle=colors.blue2; ctx.fillRect(-28,-30,56,6);
  const t=frame/10, amp=6;
  function tent(ax,ay,len,dir){
    ctx.strokeStyle=colors.pink; ctx.lineWidth=16; ctx.lineCap='round';
    ctx.beginPath(); ctx.moveTo(ax,ay);
    const c1x=ax+dir*(len*0.4), c1y=ay+8+Math.sin(t+ax)*amp;
    const c2x=ax+dir*(len*0.7), c2y=ay+16+Math.cos(t+ax)*amp;
    ctx.bezierCurveTo(c1x,c1y,c2x,c2y, ax+dir*len, ay+24); ctx.stroke();
  }
  tent(-28,14,42,-1); tent(-8,20,46,-1); tent(8,20,46,1); tent(28,14,42,1);
  // scrub tentacle + sponge
  ctx.strokeStyle=colors.pink; ctx.lineWidth=16; ctx.lineCap='round';
  ctx.beginPath(); ctx.moveTo(16,18); const wob=6+Math.sin(t*1.2)*4;
  ctx.bezierCurveTo(28,26, 36,26+wob, 44,24+wob); ctx.stroke();
  ctx.save(); ctx.translate(44,24+wob); ctx.rotate(-0.15);
  ctx.fillStyle=colors.yellow; ctx.strokeStyle='#d4b11f'; ctx.lineWidth=2;
  ctx.fillRect(-28,-14,56,28); ctx.strokeRect(-28,-14,56,28);
  if(scrubbing){
    for(let i=0;i<5;i++){ const bx=(Math.random()*46)-23, by=-18-Math.random()*18;
      ctx.fillStyle='rgba(173,230,255,.7)'; ctx.beginPath(); ctx.arc(bx,by,5+Math.random()*5,0,Math.PI*2); ctx.fill(); }
  }
  ctx.restore();
  ctx.fillStyle='#fff'; ctx.fillRect(-6,2,12,10); ctx.fillStyle=colors.blue; ctx.fillRect(-4,4,8,2);
  ctx.restore();
}

/* Draw things */
function drawThing(s){
  const x=lanes[s.lane], y=s.y;
  if(s.kind==='stain'){
    ctx.fillStyle='#6d7a85'; ctx.beginPath(); ctx.ellipse(x, y, s.w, s.h, 0, 0, Math.PI*2); ctx.fill();
    ctx.fillStyle='rgba(255,255,255,.4)'; ctx.beginPath(); ctx.ellipse(x-10, y-8, Math.max(10,s.w*0.35), Math.max(6,s.h*0.3), .5, 0, Math.PI*2); ctx.fill();
  }else if(s.kind==='coupon'){
    // green ticket
    ctx.fillStyle='rgba(18,184,134,.9)';
    ctx.beginPath(); ctx.roundRect(x-30,y-18,60,36,6); ctx.fill();
    ctx.fillStyle='#fff'; ctx.font='bold 14px system-ui'; ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText('20% OFF',x,y);
  }else if(s.kind==='cat'){
    drawCat(x,y,s);
  }else if(s.kind==='dog'){
    drawDog(x,y,s);
  }
}

function drawCat(x,y,s){
  ctx.save(); ctx.translate(x,y);
  ctx.fillStyle='#444';
  ctx.beginPath(); ctx.ellipse(0,0,s.w, s.h, 0, 0, Math.PI*2); ctx.fill(); // body
  // ears
  ctx.beginPath(); ctx.moveTo(-18,-10); ctx.lineTo(-6,-26); ctx.lineTo(6,-10); ctx.closePath(); ctx.fill();
  ctx.beginPath(); ctx.moveTo(18,-10); ctx.lineTo(6,-26); ctx.lineTo(-6,-10); ctx.closePath(); ctx.fill();
  // face
  ctx.fillStyle='#fff'; ctx.beginPath(); ctx.arc(-8,-2,4,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.arc(8,-2,4,0,Math.PI*2); ctx.fill();
  ctx.fillStyle='#111'; ctx.beginPath(); ctx.arc(-8,-2,2,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.arc(8,-2,2,0,Math.PI*2); ctx.fill();
  ctx.restore();
}

function drawDog(x,y,s){
  ctx.save(); ctx.translate(x,y);
  ctx.fillStyle='#8b5e3c';
  ctx.beginPath(); ctx.ellipse(0,0,s.w, s.h, 0, 0, Math.PI*2); ctx.fill(); // body
  // ears
  ctx.beginPath(); ctx.ellipse(-16,-16,8,12,0,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.ellipse(16,-16,8,12,0,0,Math.PI*2); ctx.fill();
  // face
  ctx.fillStyle='#fff'; ctx.beginPath(); ctx.arc(0,-2,6,0,Math.PI*2); ctx.fill();
  ctx.fillStyle='#111'; ctx.beginPath(); ctx.arc(-6,-6,2,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.arc(6,-6,2,0,Math.PI*2); ctx.fill();
  ctx.restore();
}

/* Helpers */
function laneX(i){return lanes[i];}
function reset(){
  things.length=0; score=0; lives=3; running=true; lastTs=performance.now(); elapsed=0;
  playerLane=1; couponSpawned=false; couponCollected=false; couponCode=''; hideCouponPop();
}
function moveLeft(){ playerLane=Math.max(0,playerLane-1); }
function moveRight(){ playerLane=Math.min(2,playerLane+1); }

/* Controls */
const leftBtn=document.getElementById('leftBtn'), rightBtn=document.getElementById('rightBtn'), scrubBtn=document.getElementById('scrubBtn');
leftBtn.addEventListener('click',moveLeft); rightBtn.addEventListener('click',moveRight);
scrubBtn.addEventListener('pointerdown',()=>scrubbing=true);
scrubBtn.addEventListener('pointerup',()=>scrubbing=false);
scrubBtn.addEventListener('pointerleave',()=>scrubbing=false);
// Swipe
let touchX=0,touchY=0,moved=false;
cvs.addEventListener('touchstart',e=>{const t=e.changedTouches[0];touchX=t.clientX;touchY=t.clientY;moved=false;},{passive:true});
cvs.addEventListener('touchmove',e=>{const t=e.changedTouches[0];const dx=t.clientX-touchX;const dy=t.clientY-touchY;
  if(Math.abs(dx)>40 && Math.abs(dx)>Math.abs(dy) && !moved){ if(dx<0) moveLeft(); else moveRight(); moved=true; }},{passive:true});
cvs.addEventListener('touchend',()=>{scrubbing=false},{passive:true});
window.addEventListener('keydown',e=>{
  if(e.code==='ArrowLeft') moveLeft();
  if(e.code==='ArrowRight') moveRight();
  if(e.code==='Space') scrubbing=true;
  if(!running && (e.code==='Space'||e.code==='Enter')) reset();
});
window.addEventListener('keyup',e=>{ if(e.code==='Space') scrubbing=false; });

/* Coupon UI */
const couponPop=document.getElementById('couponPop');
const couponCodeSpan=document.getElementById('couponCode');
document.getElementById('copyCoupon').addEventListener('click',async()=>{
  try{ await navigator.clipboard.writeText(couponCodeSpan.textContent); alert('Coupon copied!'); }catch(e){}
});
function showCouponPop(code){ couponCodeSpan.textContent=code; couponPop.style.display='block'; setTimeout(()=>couponPop.style.display='none', 4000); }
function hideCouponPop(){ couponPop.style.display='none'; }

/* Loop */
let frame=0;
function update(dt){
  if(!running) return;
  elapsed += dt;
  if(elapsed>=ROUND_TIME){ running=false; } // time up

  // difficulty ramp 0..1
  const progress = Math.min(1, elapsed/ROUND_TIME);
  const speed = lerp(3, 14, progress); // falls faster over time
  // dynamic spawn: faster spawns later
  const spawnEvery = lerp(0.9, 0.35, progress); // seconds between spawns

  // spawn timer
  spawnTimer -= dt;
  if(spawnTimer<=0){
    spawn(progress);
    spawnTimer = spawnEvery * (0.7 + Math.random()*0.6); // add a little randomness
  }

  // move & resolve
  for(let i=things.length-1;i>=0;i--){
    const s=things[i];
    s.y += speed*8; // tune fall speed
    if(s.y>H+60){ things.splice(i,1); continue; }

    const sameLane = s.lane===playerLane;
    const close = Math.abs((player.y-6)-s.y) < Math.max(30, s.h+12);
    if(sameLane && close){
      if(s.kind==='stain'){
        if(scrubbing){
          score += s.points;
          things.splice(i,1);
        }else{
          // bump but no life loss if not scrubbing (keeps focus on "clean vs avoid")
        }
      }else if(s.kind==='coupon'){
        if(scrubbing && !couponCollected){
          couponCollected=true;
          couponCode = genCoupon();
          localStorage.setItem('tchc_last_coupon', couponCode);
          showCouponPop(couponCode);
          things.splice(i,1);
          // bonus points for collecting coupon
          score += 50;
        }
      }else if(s.kind==='cat' || s.kind==='dog'){
        // pets are safe to pass, but penalize if scrubbing
        if(scrubbing){
          lives--;
          // brief feedback: flash red circle
          flashAt(laneX(playerLane), player.y-10);
          if(lives<=0){ running=false; }
        }
        // either way, let them pass through (don‚Äôt remove on contact)
      }
    }
  }

  // HUD
  hudScore.textContent=score;
  hudBest.textContent=Math.max(best,score);
  hudLives.textContent=lives;
  hudTime.textContent=(Math.max(0, ROUND_TIME - elapsed)).toFixed(1);
}

function render(){
  drawBackground(frame);
  for(const s of things) drawThing(s);
  drawOctopus(laneX(playerLane), player.y, frame);
  if(!running){
    // End overlay
    ctx.fillStyle='rgba(15,40,81,.78)'; ctx.fillRect(0,0,W,H);
    ctx.fillStyle='#fff'; ctx.textAlign='center';
    const finalBest = Math.max(best,score);
    if(score>best){ best=score; localStorage.setItem('cleandash_best', best); }
    ctx.font='bold 44px system-ui'; ctx.fillText(elapsed>=ROUND_TIME?'Time‚Äôs up!':'Game Over', W/2, H/2 - 60);
    ctx.font='600 22px system-ui'; ctx.fillText(`Score: ${score}   ‚Ä¢   Best: ${finalBest}`, W/2, H/2 - 20);
    ctx.font='600 18px system-ui';
    if(couponCollected){
      ctx.fillText(`Your 20% OFF code: ${couponCode}`, W/2, H/2 + 16);
      ctx.fillText(`Show at booking checkout or mention to our team.`, W/2, H/2 + 42);
    }else{
      ctx.fillText(`Missed the coupon? Try again for a chance to grab it.`, W/2, H/2 + 16);
    }
    ctx.fillText('Press Space/Enter to play again', W/2, H/2 + 70);
  }
}

function loop(ts){
  const dt = Math.min(0.05, (ts - lastTs)/1000); // cap dt
  lastTs = ts;
  if(running) update(dt);
  render();
  frame++;
  requestAnimationFrame(loop);
}

/* Visual feedback for pet penalty */
let flashFrames=0, flashX=0, flashY=0;
function flashAt(x,y){ flashFrames=18; flashX=x; flashY=y; }
const _render=render;
render=function(){
  drawBackground(frame);
  for(const s of things) drawThing(s);
  drawOctopus(laneX(playerLane), player.y, frame);
  if(flashFrames>0){
    ctx.strokeStyle='rgba(228,87,87,.85)'; ctx.lineWidth=10;
    ctx.beginPath(); ctx.arc(flashX,flashY,60,0,Math.PI*2); ctx.stroke();
    flashFrames--;
  }
  if(!running){
    ctx.fillStyle='rgba(15,40,81,.78)'; ctx.fillRect(0,0,W,H);
    ctx.fillStyle='#fff'; ctx.textAlign='center';
    const finalBest = Math.max(best,score);
    if(score>best){ best=score; localStorage.setItem('cleandash_best', best); }
    ctx.font='bold 44px system-ui'; ctx.fillText(elapsed>=ROUND_TIME?'Time‚Äôs up!':'Game Over', W/2, H/2 - 60);
    ctx.font='600 22px system-ui'; ctx.fillText(`Score: ${score}   ‚Ä¢   Best: ${finalBest}`, W/2, H/2 - 20);
    ctx.font='600 18px system-ui';
    if(couponCollected){
      ctx.fillText(`Your 20% OFF code: ${couponCode}`, W/2, H/2 + 16);
      ctx.fillText(`Show at booking checkout or mention to our team.`, W/2, H/2 + 42);
    }else{
      ctx.fillText(`Missed the coupon? Try again for a chance to grab it.`, W/2, H/2 + 16);
    }
    ctx.fillText('Press Space/Enter to play again', W/2, H/2 + 70);
  }
}

/* Spawn timing / utilities */
let spawnTimer=0.8;
function lerp(a,b,t){return a+(b-a)*t;}
function genCoupon(){
  const chars='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  let code=''; for(let i=0;i<4;i++) code+=chars[Math.floor(Math.random()*chars.length)];
  return 'TCHC20-'+code;
}

/* Start */
function start(){
  reset(); // ensures fresh state
  lastTs = performance.now();
  requestAnimationFrame(loop);
}
start();

/* Retina-friendly resize */
function resizeCanvasForDisplay(){
  const dpr=Math.min(window.devicePixelRatio||1,2);
  const cssW=cvs.clientWidth;
  const cssH=Math.floor(cssW*1.5);
  cvs.style.height=cssH+'px';
  cvs.width=Math.floor(cssW*dpr);
  cvs.height=Math.floor(cssH*dpr);
  W=cvs.width; H=cvs.height;
  lanes[0]=W*0.22; lanes[1]=W*0.5; lanes[2]=W*0.78;
  player.y=H*0.76;
}
new ResizeObserver(resizeCanvasForDisplay).observe(cvs);
resizeCanvasForDisplay();
</script>
</body>
</html>
